<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2487.5">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times; -webkit-text-stroke: #000000}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times; -webkit-text-stroke: #000000; min-height: 14.0px}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times; -webkit-text-stroke: #000000; background-color: #ffffff; min-height: 14.0px}
    span.s1 {font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE html&gt;</span></p>
<p class="p1"><span class="s1">&lt;html lang="en"&gt;</span></p>
<p class="p1"><span class="s1">&lt;head&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;meta charset="utf-8"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no,width=device-width,minimal-ui" /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags --&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;title&gt;{Evolution} {1.0}&lt;/title&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;style type='text/css'&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>canvas {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>vertical-align: middle;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.canvas-app-container {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>/* A positioned parent for loading visuals */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>width: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>height: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>position: absolute;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>align-items: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>justify-content: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>overflow: hidden;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>background: #0e1618;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.canvas-app-progress {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>visibility: hidden;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.canvas-app-progress-bar {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>visibility: hidden;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>* { margin:0; padding:0; }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>#canvas {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>outline: none;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>border: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>width: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>canvas:focus, canvas:active {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>outline: none;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>border: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>ie-dummy: expression(this.hideFocus=true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>-moz-outline-style: none;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>div {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>-webkit-tap-highlight-color: rgba(0,0,0,0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>body {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>position: fixed; /* Prevent overscroll */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>background-color: rgb(0, 0, 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>{{{DEFOLD_DEV_HEAD}}}</span></p>
<p class="p1"><span class="s1">&lt;/head&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;body&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div id="app-container" class="canvas-app-container"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;canvas id="canvas" class="canvas-app-canvas" tabindex="1" width="{{display.width}}" height="{{display.height}}"&gt;&lt;/canvas&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;!-- --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>{{{DEFOLD_DEV_INLINE}}}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script id='engine-loader' type='text/javascript' src="dmloader.js"&gt;&lt;/script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script id='engine-setup' type='text/javascript'&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>var extra_params = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>archive_location_filter: function( path ) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return ("{{DEFOLD_ARCHIVE_LOCATION_PREFIX}}" + path + "{{DEFOLD_ARCHIVE_LOCATION_SUFFIX}}");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>engine_arguments: [{{#DEFOLD_ENGINE_ARGUMENTS}}"{{.}}",{{/DEFOLD_ENGINE_ARGUMENTS}}],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>//engine_arguments: ["--verify-graphics-calls=false"],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>splash_image: "{{DEFOLD_SPLASH_IMAGE}}",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>custom_heap_size: {{DEFOLD_HEAP_SIZE}},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>disable_context_menu: true</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>Module['onRuntimeInitialized'] = function() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>Module.runApp("canvas", extra_params);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>Module["locateFile"] = function(path, scriptDirectory)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// dmengine*.wasm is hardcoded in the built JS loader for WASM,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// we need to replace it here with the correct project name.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (path == "dmengine.wasm" || path == "dmengine_release.wasm" || path == "dmengine_headless.wasm") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>path = "{{exe-name}}.wasm";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return scriptDirectory + path;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function load_engine() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var engineJS = document.createElement('script');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>engineJS.type = 'text/javascript';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (Module['isWASMSupported']) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>engineJS.src = '{{exe-name}}_wasm.js';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>engineJS.src = '{{exe-name}}_asmjs.js';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.head.appendChild(engineJS);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Make sure to resize the canvas to cover entire available area</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Resize on init, screen resize and orientation change</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function resize_game_canvas() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var app_container = document.getElementById('app-container');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var game_canvas = document.getElementById('canvas');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var dpi=window.devicePixelRatio || 1</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var width=window.innerWidth;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var height=window.innerHeight;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var targetRatio = {{display.width}}/{{display.height}};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>var actualRatio = width/height;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (actualRatio &gt; targetRatio) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>width = height * targetRatio;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>app_container.style.marginLeft = ((window.innerWidth - width) / 2) + "px"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>app_container.style.marginTop = "0px"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>height = width / targetRatio;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>app_container.style.marginLeft = "0px"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>app_container.style.marginTop = ((window.innerHeight - height) / 2) + "px"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>app_container.style.width = width+"px";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>app_container.style.height = height+"px";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>game_canvas.width = width*dpi;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>game_canvas.height = height*dpi;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>window.console.log("width: " + game_canvas.width + " &gt; "+ game_canvas.style.width)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>window.console.log("height:" + game_canvas.height + " &gt; "+ game_canvas.style.height)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>resize_game_canvas();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>window.addEventListener('resize', resize_game_canvas, false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>window.addEventListener('orientationchange', resize_game_canvas, false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>document.body.addEventListener('touchmove', function (e) { e.preventDefault(); }, { passive: false });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script id='engine-start' type='text/javascript'&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>load_engine();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</span></p>
<p class="p1"><span class="s1">&lt;/body&gt;</span></p>
<p class="p1"><span class="s1">&lt;/html&gt;</span></p>
<p class="p3"><span class="s1"></span><br></p>
</body>
</html>
